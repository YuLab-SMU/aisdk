% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/shared_session.R
\name{SharedSession}
\alias{SharedSession}
\title{SharedSession Class}
\description{
R6 class representing an enhanced session for multi-agent systems.
Extends ChatSession with:
\itemize{
\item Execution context tracking (call stack, delegation history)
\item Sandboxed code execution with safety guardrails
\item Variable scoping and access control
\item Comprehensive tracing and observability
}
}
\section{Super class}{
\code{\link[aisdk:ChatSession]{aisdk::ChatSession}} -> \code{SharedSession}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-SharedSession-new}{\code{SharedSession$new()}}
\item \href{#method-SharedSession-push_context}{\code{SharedSession$push_context()}}
\item \href{#method-SharedSession-pop_context}{\code{SharedSession$pop_context()}}
\item \href{#method-SharedSession-get_context}{\code{SharedSession$get_context()}}
\item \href{#method-SharedSession-set_global_task}{\code{SharedSession$set_global_task()}}
\item \href{#method-SharedSession-execute_code}{\code{SharedSession$execute_code()}}
\item \href{#method-SharedSession-get_var}{\code{SharedSession$get_var()}}
\item \href{#method-SharedSession-set_var}{\code{SharedSession$set_var()}}
\item \href{#method-SharedSession-list_vars}{\code{SharedSession$list_vars()}}
\item \href{#method-SharedSession-summarize_vars}{\code{SharedSession$summarize_vars()}}
\item \href{#method-SharedSession-create_scope}{\code{SharedSession$create_scope()}}
\item \href{#method-SharedSession-delete_scope}{\code{SharedSession$delete_scope()}}
\item \href{#method-SharedSession-trace_event}{\code{SharedSession$trace_event()}}
\item \href{#method-SharedSession-get_trace}{\code{SharedSession$get_trace()}}
\item \href{#method-SharedSession-clear_trace}{\code{SharedSession$clear_trace()}}
\item \href{#method-SharedSession-trace_summary}{\code{SharedSession$trace_summary()}}
\item \href{#method-SharedSession-set_access_control}{\code{SharedSession$set_access_control()}}
\item \href{#method-SharedSession-check_permission}{\code{SharedSession$check_permission()}}
\item \href{#method-SharedSession-get_sandbox_mode}{\code{SharedSession$get_sandbox_mode()}}
\item \href{#method-SharedSession-set_sandbox_mode}{\code{SharedSession$set_sandbox_mode()}}
\item \href{#method-SharedSession-print}{\code{SharedSession$print()}}
\item \href{#method-SharedSession-clone}{\code{SharedSession$clone()}}
}
}
\if{html}{\out{
<details><summary>Inherited methods</summary>
<ul>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="append_message"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-append_message'><code>aisdk::ChatSession$append_message()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="as_list"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-as_list'><code>aisdk::ChatSession$as_list()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="clear_history"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-clear_history'><code>aisdk::ChatSession$clear_history()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="clear_memory"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-clear_memory'><code>aisdk::ChatSession$clear_memory()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="eval_in_session"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-eval_in_session'><code>aisdk::ChatSession$eval_in_session()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="get_envir"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-get_envir'><code>aisdk::ChatSession$get_envir()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="get_history"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-get_history'><code>aisdk::ChatSession$get_history()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="get_last_response"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-get_last_response'><code>aisdk::ChatSession$get_last_response()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="get_memory"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-get_memory'><code>aisdk::ChatSession$get_memory()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="get_model_id"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-get_model_id'><code>aisdk::ChatSession$get_model_id()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="list_envir"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-list_envir'><code>aisdk::ChatSession$list_envir()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="list_memory"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-list_memory'><code>aisdk::ChatSession$list_memory()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="restore_from_list"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-restore_from_list'><code>aisdk::ChatSession$restore_from_list()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="save"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-save'><code>aisdk::ChatSession$save()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="send"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-send'><code>aisdk::ChatSession$send()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="send_stream"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-send_stream'><code>aisdk::ChatSession$send_stream()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="set_memory"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-set_memory'><code>aisdk::ChatSession$set_memory()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="stats"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-stats'><code>aisdk::ChatSession$stats()</code></a></span></li>
<li><span class="pkg-link" data-pkg="aisdk" data-topic="ChatSession" data-id="switch_model"><a href='../../aisdk/html/ChatSession.html#method-ChatSession-switch_model'><code>aisdk::ChatSession$switch_model()</code></a></span></li>
</ul>
</details>
}}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-new"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-new}{}}}
\subsection{Method \code{new()}}{
Initialize a new SharedSession.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$new(
  model = NULL,
  system_prompt = NULL,
  tools = NULL,
  hooks = NULL,
  max_steps = 10,
  registry = NULL,
  sandbox_mode = "strict",
  trace_enabled = TRUE
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{model}}{A LanguageModelV1 object or model string ID.}

\item{\code{system_prompt}}{Optional system prompt for the conversation.}

\item{\code{tools}}{Optional list of Tool objects.}

\item{\code{hooks}}{Optional HookHandler object.}

\item{\code{max_steps}}{Maximum steps for tool execution loops. Default 10.}

\item{\code{registry}}{Optional ProviderRegistry for model resolution.}

\item{\code{sandbox_mode}}{Sandbox mode: "strict", "permissive", or "none". Default "strict".}

\item{\code{trace_enabled}}{Enable execution tracing. Default TRUE.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-push_context"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-push_context}{}}}
\subsection{Method \code{push_context()}}{
Push an agent onto the execution stack.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$push_context(agent_name, task, parent_agent = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{agent_name}}{Name of the agent being activated.}

\item{\code{task}}{The task being delegated.}

\item{\code{parent_agent}}{Name of the delegating agent (or NULL for root).}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Invisible self for chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-pop_context"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-pop_context}{}}}
\subsection{Method \code{pop_context()}}{
Pop the current agent from the execution stack.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$pop_context(result = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{result}}{Optional result from the completed agent.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
The popped context, or NULL if stack was empty.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-get_context"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-get_context}{}}}
\subsection{Method \code{get_context()}}{
Get the current execution context.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$get_context()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A list with current_agent, depth, and delegation_stack.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-set_global_task"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-set_global_task}{}}}
\subsection{Method \code{set_global_task()}}{
Set the global task (user's original request).
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$set_global_task(task)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{task}}{The global task description.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Invisible self for chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-execute_code"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-execute_code}{}}}
\subsection{Method \code{execute_code()}}{
Execute R code in a sandboxed environment.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$execute_code(
  code,
  scope = "global",
  timeout_ms = 30000,
  capture_output = TRUE
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{code}}{R code to execute (character string).}

\item{\code{scope}}{Variable scope: "global", "agent", or a custom scope name.}

\item{\code{timeout_ms}}{Execution timeout in milliseconds. Default 30000.}

\item{\code{capture_output}}{Capture stdout/stderr. Default TRUE.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A list with result, output, error, and duration_ms.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-get_var"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-get_var}{}}}
\subsection{Method \code{get_var()}}{
Get a variable from a specific scope.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$get_var(name, scope = "global", default = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{name}}{Variable name.}

\item{\code{scope}}{Scope name. Default "global".}

\item{\code{default}}{Default value if not found.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
The variable value or default.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-set_var"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-set_var}{}}}
\subsection{Method \code{set_var()}}{
Set a variable in a specific scope.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$set_var(name, value, scope = "global")}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{name}}{Variable name.}

\item{\code{value}}{Variable value.}

\item{\code{scope}}{Scope name. Default "global".}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Invisible self for chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-list_vars"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-list_vars}{}}}
\subsection{Method \code{list_vars()}}{
List variables in a scope.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$list_vars(scope = "global", pattern = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{scope}}{Scope name. Default "global".}

\item{\code{pattern}}{Optional pattern to filter names.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Character vector of variable names.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-summarize_vars"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-summarize_vars}{}}}
\subsection{Method \code{summarize_vars()}}{
Get a summary of all variables in a scope.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$summarize_vars(scope = "global")}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{scope}}{Scope name. Default "global".}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A data frame with name, type, and size information.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-create_scope"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-create_scope}{}}}
\subsection{Method \code{create_scope()}}{
Create a new variable scope.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$create_scope(scope_name, parent_scope = "global")}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{scope_name}}{Name for the new scope.}

\item{\code{parent_scope}}{Parent scope name. Default "global".}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Invisible self for chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-delete_scope"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-delete_scope}{}}}
\subsection{Method \code{delete_scope()}}{
Delete a variable scope.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$delete_scope(scope_name)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{scope_name}}{Name of the scope to delete.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Invisible self for chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-trace_event"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-trace_event}{}}}
\subsection{Method \code{trace_event()}}{
Record a trace event.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$trace_event(event_type, data = list())}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{event_type}}{Type of event (e.g., "context_push", "code_execution").}

\item{\code{data}}{Event data as a list.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Invisible self for chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-get_trace"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-get_trace}{}}}
\subsection{Method \code{get_trace()}}{
Get the execution trace.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$get_trace(event_types = NULL, agent = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{event_types}}{Optional filter by event types.}

\item{\code{agent}}{Optional filter by agent name.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A list of trace events.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-clear_trace"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-clear_trace}{}}}
\subsection{Method \code{clear_trace()}}{
Clear the execution trace.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$clear_trace()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Invisible self for chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-trace_summary"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-trace_summary}{}}}
\subsection{Method \code{trace_summary()}}{
Get trace summary statistics.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$trace_summary()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A list with event counts, agent activity, and timing info.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-set_access_control"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-set_access_control}{}}}
\subsection{Method \code{set_access_control()}}{
Set access control for an agent.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$set_access_control(agent_name, permissions)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{agent_name}}{Agent name.}

\item{\code{permissions}}{List of permissions (read_scopes, write_scopes, tools).}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Invisible self for chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-check_permission"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-check_permission}{}}}
\subsection{Method \code{check_permission()}}{
Check if an agent has permission for an action.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$check_permission(agent_name, action, target)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{agent_name}}{Agent name.}

\item{\code{action}}{Action type: "read", "write", or "tool".}

\item{\code{target}}{Target scope or tool name.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
TRUE if permitted, FALSE otherwise.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-get_sandbox_mode"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-get_sandbox_mode}{}}}
\subsection{Method \code{get_sandbox_mode()}}{
Get sandbox mode.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$get_sandbox_mode()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
The current sandbox mode.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-set_sandbox_mode"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-set_sandbox_mode}{}}}
\subsection{Method \code{set_sandbox_mode()}}{
Set sandbox mode.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$set_sandbox_mode(mode)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{mode}}{Sandbox mode: "strict", "permissive", or "none".}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Invisible self for chaining.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-print"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-print}{}}}
\subsection{Method \code{print()}}{
Print method for SharedSession.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$print()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SharedSession-clone"></a>}}
\if{latex}{\out{\hypertarget{method-SharedSession-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SharedSession$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
